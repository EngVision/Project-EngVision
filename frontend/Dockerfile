# Stage 1: Build stage
FROM node:18 as build-stage

WORKDIR /frontend
COPY . .

ARG VITE_BASE_URL
ARG VITE_SERVER_FILES_URL
ARG VITE_GA4_TRACKING_ID
ARG VITE_SENTRY_DSN

ENV VITE_BASE_URL ${VITE_BASE_URL}
ENV VITE_SERVER_FILES_URL ${VITE_SERVER_FILES_URL}
ENV VITE_GA4_TRACKING_ID ${VITE_GA4_TRACKING_ID}
ENV VITE_SENTRY_DSN ${VITE_SENTRY_DSN}

RUN yarn ci
RUN yarn build

CMD ["yarn", "preview" ]

EXPOSE 3000